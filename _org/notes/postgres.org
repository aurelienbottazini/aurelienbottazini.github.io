#+BEGIN_HTML
---
layout: notes
---
#+END_HTML
* Resetting a database

  More like resetting the public schema, but this is what I want most
  of the time.

  #+begin_src sql
    DROP SCHEMA public CASCADE;
    CREATE SCHEMA public;
    GRANT ALL ON SCHEMA public TO postgres;
    GRANT ALL ON SCHEMA public TO public;
    COMMENT ON SCHEMA public IS 'standard public schema';
  #+end_src

* Importing

  Two ways.

  For dump files with pg_dump
  For sql files with psql

  Both these commands can take arguments for host (-h), port (-p),
  user (-U) and database (-d)

  #+begin_src sql
    pg_restore -d development -h "$DB_PORT_5432_TCP_ADDR" -p "$DB_PORT_5432_TCP_PORT" ./staging.dump -U postgres --clean
    psql -d development -h "$DB_PORT_5432_TCP_ADDR" -p "$DB_PORT_5432_TCP_PORT" < staging.sql
  #+end_src

* EngineYard

  Create a backup: ~sudo -i eybackup -e postgresql --new-backup~

* Create a new postgres database (after updating postgres)
  ~initdb -D /usr/local/var/postgres9.5/~
