(function(){"use strict";var TEST_GLYPH="X";var TEST_SIZE=100;var TEST_SIZE_PX=TEST_SIZE+"px";var ZEROPX="0px";var LINEHEIGHT_DEFAULT=1.15;var _fontMetricsCache={};function getLineMetrics(css){var fontSize=parseFloat(css.fontSize);var lineHeight=css.lineHeight==="normal"?LINEHEIGHT_DEFAULT*fontSize:parseFloat(css.lineHeight);return{leading:lineHeight-fontSize,lineHeight:lineHeight,fontSize:fontSize}}function createTestContainingBlock(document){var div=document.createElement("div");div.style.position="fixed";div.style.padding=ZEROPX;div.style.opacity="0";div.style.fontSize=TEST_SIZE_PX;div.style.lineHeight="1";document.body.appendChild(div);return div}function newTestGlyph(container){var span=container.ownerDocument.createElement("span");span.textContent=TEST_GLYPH;if(container){container.appendChild(span)}return span}function destroyTestContainingBlock(element){element.ownerDocument.body.removeChild(element)}function measureCapHeightRatio(testParent,fontFamily,width,height){var ratio=-1;var canvas=document.createElement("canvas");canvas.width=width;canvas.height=height;testParent.appendChild(canvas);var ctx=canvas.getContext("2d");ctx.font=TEST_SIZE_PX+" "+fontFamily;ctx.fillStyle="#ffffff";ctx.fillRect(0,0,ctx.canvas.width,ctx.canvas.height);ctx.fillStyle="#000000";ctx.textBaseline="top";ctx.fillText("E",0,0);var middleYline=ctx.getImageData(Math.ceil(canvas.width/2),0,1,canvas.height);var bottomL=null;function _isBlack(imageData,pxIndex){var firstByte=pxIndex*4;var red=imageData.data[firstByte];var green=imageData.data[firstByte+1];var blue=imageData.data[firstByte+2];return red===0||green===0||blue===0?true:false}for(var y=canvas.height-1;y>=0;y--){if(_isBlack(middleYline,y)){bottomL=y;break}}for(var y=0;y<canvas.height;y++){if(_isBlack(middleYline,y)){ratio=(bottomL+1-y)/height;break}}return ratio}function getFontMetrics(document,fontFamily){var ret=_fontMetricsCache[fontFamily];if(ret){return ret}ret={baselineRatio:undefined,capHeightRatio:undefined};var testBlock=createTestContainingBlock(document);testBlock.style.fontFamily=fontFamily;var zeroX=newTestGlyph(testBlock);zeroX.style.fontSize=ZEROPX;var largeX=newTestGlyph(testBlock);ret.baselineRatio=zeroX.offsetTop/TEST_SIZE;try{ret.capHeightRatio=measureCapHeightRatio(testBlock,fontFamily,largeX.offsetWidth,TEST_SIZE)}catch(e){throw new Error("[dropcap.js] Error computing font metrics: "+e.message)}finally{destroyTestContainingBlock(testBlock)}_fontMetricsCache[fontFamily]=ret;return ret}var DCJS_DESCENDER_CLASS="dcjs-descender";function toPxLength(pxNumber){return pxNumber+"px"}function hasDescenderClass(dcapElement){if(dcapElement.classList.contains(DCJS_DESCENDER_CLASS)){return true}}function isDescenderChar(dcapElement){var descenders="gjpqQ";if(descenders.indexOf(dcapElement.textContent)===-1){return false}return true}function resetDropcapStyle(element){if(element.dcapjs){element.style.cssFloat="";element.style.padding="";element.style.fontSize="";element.style.lineHeight="";element.style.marginTop=""}}function layoutDropcap(dropcapElement,heightInLines,baselinePos){if(!baselinePos){baselinePos=heightInLines}if(baselinePos==1&&heightInLines==1){resetDropcapStyle(dropcapElement);return}var doc=dropcapElement.ownerDocument;var dcap=dropcapElement;var par=dcap.parentNode;var dcapCSS=window.getComputedStyle(dcap);var parCSS=window.getComputedStyle(par);var dcapFontMetrics=getFontMetrics(doc,dcapCSS.fontFamily);var parFontMetrics=getFontMetrics(doc,parCSS.fontFamily);var dcapCapHeightRatio=dcapFontMetrics.capHeightRatio;var parLineMetrics=getLineMetrics(parCSS);var ascend=(parFontMetrics.baselineRatio-parFontMetrics.capHeightRatio)*parLineMetrics.fontSize;var dcapHeightInPx=heightInLines*parLineMetrics.lineHeight-parLineMetrics.leading-ascend-(1-parFontMetrics.baselineRatio)*parLineMetrics.fontSize;var dcapFontSizeInPx=dcapHeightInPx/dcapCapHeightRatio;dcap.dcapjs=true;dcap.style.cssFloat="left";dcap.style.padding=ZEROPX;dcap.style.fontSize=toPxLength(dcapFontSizeInPx);dcap.style.lineHeight=ZEROPX;var verticalOffset=parLineMetrics.leading/2+ascend;verticalOffset-=(heightInLines-baselinePos)*parLineMetrics.lineHeight;dcap.style.marginTop=toPxLength(verticalOffset);if(heightInLines>baselinePos){var parMarginTop=parseFloat(parCSS.marginTop);par.style.marginTop=toPxLength(parMarginTop+-1*verticalOffset)}var descendAdjust=0;if(isDescenderChar(dcap)){descendAdjust=dcapFontSizeInPx*(1-dcapFontMetrics.baselineRatio)}else if(hasDescenderClass(dcap)){descendAdjust=dcapFontSizeInPx-dcapHeightInPx}dcap.style.height=toPxLength(dcapHeightInPx+descendAdjust);var strut=dcap.dcapjsStrut;if(!strut){strut=doc.createElement("span");strut.style.display="inline-block";dcap.appendChild(strut);dcap.dcapjsStrut=strut}strut.style.height=toPxLength(dcapHeightInPx)}function getCSSPropertyName(property){var _supportElement=window.document.body?window.document.body:document.createElement("div");function _supported(p){return p in _supportElement.style}if(_supported(property)){return property}var prefix=["-webkit-","-moz-","-ms-","-o"];for(var i=0;i<prefix.length;i++){var name=prefix[i]+property;if(_supported(name)){return name}}return null}window.Dropcap={options:{runEvenIfInitialLetterExists:true},layout:function(dropcapRef,heightInLines,baselinePos){if(this.options.runEvenIfInitialLetterExists==false){var initialLetter=getCSSPropertyName("initial-letter");if(initialLetter){return}}if(heightInLines<1||baselinePos&&baselinePos<1){throw new RangeError("Dropcap.layout expects the baseline position and height to be 1 or above")}if(dropcapRef instanceof HTMLElement){layoutDropcap(dropcapRef,heightInLines,baselinePos)}else if(dropcapRef instanceof NodeList){var forEach=Array.prototype.forEach;forEach.call(dropcapRef,function(dropcap){layoutDropcap(dropcap,heightInLines,baselinePos)})}else{throw new TypeError("Dropcap.layout expects a single HTMLElement or a NodeList")}}}})();var setUpCaps=function(){var dropcaps=document.querySelectorAll(".dropcap");window.Dropcap.layout(dropcaps,3)};window.addEventListener("load",setUpCaps);document.addEventListener("DOMContentLoaded",function(event){var links=document.querySelectorAll("#main_navigation ul li a");var pathname=location.href;for(var i=0,length=links.length;i<length;i+=1){if(pathname===links[i].href){links[i].classList.add("current")}}});var isAnimating=false;document.querySelectorAll('#main_navigation [data-type="page-transition"]').forEach(function(e){e.addEventListener("click",function(event){event.preventDefault();var newPage=this.getAttribute("href");var links=document.querySelectorAll("#main_navigation ul li a");var pathname=location.href;for(var i=0,length=links.length;i<length;i+=1){links[i].classList.remove("current")}this.classList.add("current");if(!isAnimating)changePage(newPage,true)})});function changePage(url,bool){isAnimating=true;document.querySelector("body").classList.add("page-is-changing");loadNewContent(url,bool)}function loadNewContent(url,bool){var xhr=new XMLHttpRequest;xhr.addEventListener("load",function(){var doc=document.createElement("div");doc.innerHTML=this.responseText;var frame=doc.querySelector("#wrapper");document.querySelector("#wrapper").replaceWith(frame)});setTimeout(function(){isAnimating=false;document.querySelector("body").classList.remove("page-is-changing");if(url!=window.location){window.history.pushState({path:url},"",url)}},200);xhr.open("GET",url);xhr.send()}window.addEventListener("popstate",function(){var newPageArray=location.pathname.split("/"),newPage=newPageArray[newPageArray.length-1];if(!isAnimating)changePage(newPage)});